!function(e){function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var r={};n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:t})},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=0)}([function(e,n,r){"use strict";function t(e,n,r,t){var o=(0,u.default)(e);if(o)return o in u?u[o](r,n,t):void console.warn("Unhandled op: "+o)}function o(e){for(var n=[].concat(function(e){if(Array.isArray(e)){for(var n=0,r=Array(e.length);n<e.length;n++)r[n]=e[n];return r}return Array.from(e)}(document.querySelectorAll("[data-op]"))),r=0;r<n.length;r++){var o=n[r];o.innerHTML=t(o.dataset.op,o.dataset,e)}}function i(e,n){var r=n.target.dataset.handler;return!!r&&t(r,n.target.dataset,e,n)}var u=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}(r(1));document.dispatchEvent(new CustomEvent("locate-services",{detail:function(e,n){e?console.error(e):(document.addEventListener("click",function(e){return function(e,n){"SELECT"!==n.target.tagName&&i(e,n)&&n.preventDefault()}(n,e)}),document.addEventListener("change",function(e){return i(n,e)}),document.addEventListener("redraw",function(){return o(n)}),document.dispatchEvent(new Event("redraw")))}}))},function(e,n,r){"use strict";function t(e){return e?(0,a.ul)(!0,e.providers().filter(function(e){return e}).map(function(n){return(0,a.li)(function(e,n){var r={service:e.name,provider:n.name};return(0,a.button)("select-provider",r,n.name||"??")}(e,n))})):"???"}function o(e){return e?a.box.big((0,a.sub)(e.name+" provider"),function(e){var n=e.provider;return n?(0,a.b)(n.description+" ( "+n.name+" ) "+(0,a.button)("deselect-provider",{service:e.name}," X ")):(0,a.b)("(none)")}(e),function(e){if(e){var n=(0,a.label)("Test: ",(0,a.select)("test-service-method",{service:e.name},Array.from((0,u.userFunctions)(e)))),r=a.div.withClass("test-area");return(0,a.div)(n,r)}}(e),"Available: "+t(e)):(0,a.section)("(nothing)")}function i(e,n){var r=Object.values(e).find(function(e){return e.name===n.service});if(!r)throw new Error("Service not known: "+n.service);return r}Object.defineProperty(n,"__esModule",{value:!0}),n.invokeTestMethod=void 0;n.invokeTestMethod=function(){var e=function(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,r){function t(o,i){try{var u=n[o](i),a=u.value}catch(e){return void r(e)}if(!u.done)return Promise.resolve(a).then(function(e){t("next",e)},function(e){t("throw",e)});e(a)}return t("next")})}}(regeneratorRuntime.mark(function e(n,r,t){var o,u,a,c,s,f,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=function(e,n){var r=i(e,n);return{service:r,method:n.method?r[n.method]:void 0}}(n,r),u=o.service,a=o.method,c=Array.from(t.target.parentElement.querySelectorAll("input[type=text]")).map(function(e){return JSON.parse(e.value)}),s=t.target.parentElement.querySelector(".messages"),f=function(e){return"["+(new Date).toLocaleTimeString()+"] "+e},s&&(s.innerHTML=f("Running...<br />")),e.prev=5,e.next=8,a.apply(u,c);case 8:l=e.sent,console.log(l),s&&(s.innerHTML+=f(JSON.stringify(l))),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(5),console.error(e.t0),s&&(s.innerHTML+=e.t0.stack);case 17:case"end":return e.stop()}},e,this,[[5,13]])}));return function(n,r,t){return e.apply(this,arguments)}}();n.summarizeServices=function(e){return Object.values(e).map(o).join("")},n.selectProvider=function(e,n){var r=function(e,n){var r=i(e,n),t=n.provider?r.providers().find(function(e){return e.name===n.provider}):r.provider;if(!t)throw new Error("Unknown/unspecified provider: "+n.provider);return{service:r,provider:t}}(e,n),t=r.service,o=r.provider;t.select(o),document.dispatchEvent(new Event("redraw"))},n.deselectProvider=function(e,n){i(e,n).deselect(),document.dispatchEvent(new Event("redraw"))},n.testServiceMethod=function(e,n,r){var t=i(e,n),o=r.target.value,u=r.target.parentElement.parentElement.querySelector(".test-area");u&&(u.innerHTML=function(e,n){if(!n)return"";e[n].length;var r={service:e.name,method:n};return(0,a.div)((0,a.button)("invokeTestMethod",r,"Invoke"),a.div.withClass("messages"))}(t,o))};var u=r(2),a=r(3);n.default=function(e){return e?e.replace(/-./g,function(e){return e[1].toUpperCase()}):e}},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(e){return function e(n){return n&&n!==Object.prototype&&Object.getOwnPropertyNames(n).concat(e(Object.getPrototypeOf(n))||[])}(e).filter(function(n){return"function"==typeof e[n]})};n.userFunctions=function(e){return new Set(t(e).filter(function(e){return"constructor"!==e&&!~e.indexOf("__")}))}},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(e){return void 0!==e},o=function(e){return Object.keys(e||{}).reduce(function(n,r){return n+" data-"+r+'="'+e[r]+'"'},"")},i=function(e){return e.filter(t).join("<br />")};n.sub=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return'<span class="sub-heading">'+i(n)+"</span>"},n.b=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return'<span class="bold">'+i(n)+"</span>"};(n.box=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return'<div class="box">'+i(n)+"</div>"}).big=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return'<div class="box big-box">'+i(n)+"</div>"};n.section=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return"<section>"+i(n)+"</section>"};(n.div=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return"<div>"+i(n)+"</div>"}).withClass=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),t=1;t<n;t++)r[t-1]=arguments[t];return'<div class="'+e+'">'+i(r)+"</div>"};n.article=function(e,n){return"<article><header>"+e+"</header>"+n+"</article>"},n.ul=function(e,n){return'<ul class="'+(e?"inline":"")+'">'+n.join("")+"</ul>"},n.li=function(e){return"<li>"+e+"</li>"},n.label=function(e,n){return"<label>"+e+n+"</label>"},n.button=function(e,n,r){return'<button data-handler="'+e+'" '+(n?o(n):"")+">"+r+"</button>"};var u=n.option=function(e,n){return'<option value="'+e+'">'+(n||e)+"</option>"},a=n.options=function(e){return"<option></option>"+e.map(function(e){return u(e)})};n.select=function(e,n,r){return'<select data-handler="'+e+'" '+o(n)+">"+a(r)+"</select>"}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgYmMxYjAwMjhhNDNjZWJkNTUzYmYiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbnNvbGUvbWFpbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvY29uc29sZS9vcHMuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2Z1bmMvcmVmbGVjdGlvbi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvZnVuYy9odG1sLmpzIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImluc3RhbGxlZE1vZHVsZXMiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJlbm9wIiwiZGF0YU9wIiwiZGF0YSIsInNlcnZpY2VzIiwiZSIsIm9wIiwib3BzIiwiZGVmYXVsdCIsImNvbnNvbGUiLCJ3YXJuIiwicmVkcmF3IiwiX2FyciIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIl9pIiwibGVuZ3RoIiwiaG9zdCIsImlubmVySFRNTCIsImRhdGFzZXQiLCJpbnZva2VIYW5kbGVyIiwiaGFuZGxlciIsInRhcmdldCIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImVyciIsImVycm9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRhZ05hbWUiLCJwcmV2ZW50RGVmYXVsdCIsImludm9rZUNsaWNrSGFuZGxlciIsIkV2ZW50IiwiYXZhaWxhYmxlUHJvdmlkZXJzIiwic2VydmljZSIsIl9odG1sIiwidWwiLCJwcm92aWRlcnMiLCJmaWx0ZXIiLCJ4IiwibWFwIiwibGkiLCJwcm92aWRlciIsImJ1dHRvbiIsInNlbGVjdFByb3ZpZGVyQnV0dG9uIiwic3VtbWFyaXplU2VydmljZSIsImJveCIsImJpZyIsInN1YiIsImIiLCJkZXNjcmlwdGlvbiIsInN1bW1hcml6ZVByb3ZpZGVyIiwic2VsZWN0VGVzdCIsImxhYmVsIiwic2VsZWN0IiwiQXJyYXkiLCJmcm9tIiwiX3JlZmxlY3Rpb24iLCJ1c2VyRnVuY3Rpb25zIiwiZGl2Iiwid2l0aENsYXNzIiwic2VydmljZU1ldGhvZHMiLCJzZWN0aW9uIiwib3BTZXJ2aWNlIiwidmFsdWVzIiwiZmluZCIsIkVycm9yIiwiX2NhbGxlZSIsIl9vcFNlcnZpY2VNZXRob2QiLCJtZXRob2QiLCJwYXJhbWV0ZXJzIiwibWVzc2FnZUhvc3QiLCJ0aW1lc3RhbXAiLCJyZXN1bHQiLCJyZWdlbmVyYXRvclJ1bnRpbWUiLCJ3cmFwIiwiX2NvbnRleHQiLCJwcmV2IiwibmV4dCIsInVuZGVmaW5lZCIsIm9wU2VydmljZU1ldGhvZCIsInBhcmVudEVsZW1lbnQiLCJKU09OIiwicGFyc2UiLCJ2YWx1ZSIsInF1ZXJ5U2VsZWN0b3IiLCJEYXRlIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwiYXBwbHkiLCJzZW50IiwibG9nIiwic3RyaW5naWZ5IiwidDAiLCJzdGFjayIsInN0b3AiLCJ0aGlzIiwic3VtbWFyaXplU2VydmljZXMiLCJqb2luIiwic2VsZWN0UHJvdmlkZXIiLCJfb3BTZXJ2aWNlUHJvdmlkZXIiLCJvcFNlcnZpY2VQcm92aWRlciIsImRlc2VsZWN0UHJvdmlkZXIiLCJkZXNlbGVjdCIsInRlc3RTZXJ2aWNlTWV0aG9kIiwiaW52b2tlRGF0YSIsInRlc3RBcmVhIiwicmVwbGFjZSIsInRvVXBwZXJDYXNlIiwiZGVlcEZ1bmN0aW9ucyIsImRlZXBQcm9wcyIsImdldE93blByb3BlcnR5TmFtZXMiLCJnZXRQcm90b3R5cGVPZiIsIlNldCIsImluZGV4T2YiLCJpc0RlZmluZWQiLCJkYXRhZnkiLCJrZXlzIiwicmVkdWNlIiwicmV0Iiwia2V5IiwiYnJlYWtVcCIsInhzIiwiX2xlbiIsImFyZ3VtZW50cyIsIl9rZXkiLCJfbGVuMiIsIl9rZXkyIiwiX2xlbjMiLCJfa2V5MyIsIl9sZW40IiwiX2tleTQiLCJfbGVuNSIsIl9rZXk1IiwiX2xlbjYiLCJfa2V5NiIsImNsYXNzTmFtZSIsIl9sZW43IiwiX2tleTciLCJhcnRpY2xlIiwiaGVhZCIsImJvZHkiLCJpbmxpbmUiLCJ0IiwiY29udGVudCIsIm9wdGlvbiIsInRleHQiLCJvcHRpb25zIiwib3B0cyJdLCJtYXBwaW5ncyI6ImFBSUEsU0FBQUEsRUFBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE9BQUFDLEVBQUFELEdBQUFFLFFBR0EsSUFBQUMsRUFBQUYsRUFBQUQsSUFDQUksRUFBQUosRUFDQUssR0FBQSxFQUNBSCxZQVVBLE9BTkFJLEVBQUFOLEdBQUFPLEtBQUFKLEVBQUFELFFBQUFDLElBQUFELFFBQUFILEdBR0FJLEVBQUFFLEdBQUEsRUFHQUYsRUFBQUQsUUF2QkEsSUFBQUQsS0E0QkFGLEVBQUFTLEVBQUFGLEVBR0FQLEVBQUFVLEVBQUFSLEVBR0FGLEVBQUFXLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQWIsRUFBQWMsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FDQUssY0FBQSxFQUNBQyxZQUFBLEVBQ0FDLElBQUFOLEtBTUFiLEVBQUFvQixFQUFBLFNBQUFoQixHQUNBLElBQUFTLEVBQUFULEtBQUFpQixXQUNBLFdBQTJCLE9BQUFqQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFKLEVBQUFXLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQWIsRUFBQWMsRUFBQSxTQUFBUSxFQUFBQyxHQUFzRCxPQUFBUixPQUFBUyxVQUFBQyxlQUFBakIsS0FBQWMsRUFBQUMsSUFHdER2QixFQUFBMEIsRUFBQSxHQUdBMUIsSUFBQTJCLEVBQUEsa0NDeERBLFNBQVNDLEVBQU1DLEVB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S0FBTSxJQUFsRSxTQUNMeEQsS0FBSyxTQUFBRixHQUFBLGFBQVlBLEVBQVosU0FFTGMsUUFBUSxTQUFFeUYsRUFBR2pLLEdBQUwsZ0JBQXNCaUssRUFBSWpLLEVBQTFCLFlBQ1I4RCxTQUFTLFNBQUV2QyxFQUFJSCxFQUFNOEksR0FBWiwrQkFBa0QzSSxFQUFsRCxNQUF5REgsRUFBT2tILEVBQVFsSCxHQUFTLElBQWpGLElBQXVGOEksRUFBdkYsYUFOZixJQU9NQyxXQUFTLFNBQUU1RCxFQUFPNkQsR0FBVCx3QkFBcUM3RCxFQUFyQyxNQUErQzZELEdBQVE3RCxHQUF2RCxhQUNUOEQsWUFBVSxTQUFBQyxHQUFBLDBCQUE0QkEsRUFBSzNHLElBQUssU0FBQXZELEdBQUEsT0FBSytKLEVBQVEvSixNQUM3RHFFLFNBQVMsU0FBRWxELEVBQUlILEVBQU1rSixHQUFaLCtCQUErQy9JLEVBQS9DLEtBQXNEK0csRUFBUWxILEdBQTlELElBQXdFaUosRUFBU0MsR0FBakYiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDApO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIHdlYnBhY2svYm9vdHN0cmFwIGJjMWIwMDI4YTQzY2ViZDU1M2JmIiwiLyogZ2xvYmFsIGRvY3VtZW50IEN1c3RvbUV2ZW50LCBFdmVudCAqL1xuXG4vLyBpbXBvcnQgc2VsZlRlc3QgZnJvbSBcIi4vc2VsZi10ZXN0XCI7XG5pbXBvcnQgb3BpZnksICogYXMgb3BzIGZyb20gXCIuL29wc1wiO1xuXG5mdW5jdGlvbiBlbm9wKCBkYXRhT3AsIGRhdGEsIHNlcnZpY2VzLCBlICkge1xuXG4gICAgY29uc3Qgb3AgPSBvcGlmeSggZGF0YU9wICk7XG4gICAgaWYgKCAhb3AgKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIGlmICggb3AgaW4gb3BzICkgcmV0dXJuIG9wc1sgb3AgXSggc2VydmljZXMsIGRhdGEsIGUgKTtcbiAgICBjb25zb2xlLndhcm4oIGBVbmhhbmRsZWQgb3A6ICR7b3B9YCApO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG5cbn1cblxuZnVuY3Rpb24gcmVkcmF3KCBzZXJ2aWNlcyApIHtcblxuICAgIGZvciAoIGNvbnN0IGhvc3Qgb2YgWyAuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBcIltkYXRhLW9wXVwiICkgXSApIHtcblxuICAgICAgICBob3N0LmlubmVySFRNTCA9IGVub3AoIGhvc3QuZGF0YXNldC5vcCwgaG9zdC5kYXRhc2V0LCBzZXJ2aWNlcyApO1xuXG4gICAgfVxuXG59XG5cbmZ1bmN0aW9uIGludm9rZUhhbmRsZXIoIHNlcnZpY2VzLCBlICkge1xuXG4gICAgY29uc3QgeyBoYW5kbGVyIH0gPSBlLnRhcmdldC5kYXRhc2V0O1xuICAgIGlmICggIWhhbmRsZXIgKSByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIGVub3AoIGhhbmRsZXIsIGUudGFyZ2V0LmRhdGFzZXQsIHNlcnZpY2VzLCBlICk7XG5cbn1cblxuZnVuY3Rpb24gaW52b2tlQ2xpY2tIYW5kbGVyKCBzZXJ2aWNlcywgZSApIHtcblxuICAgIGlmICggZS50YXJnZXQudGFnTmFtZSA9PT0gXCJTRUxFQ1RcIiApIHJldHVybjtcbiAgICBpZiAoIGludm9rZUhhbmRsZXIoIHNlcnZpY2VzLCBlICkgKSBlLnByZXZlbnREZWZhdWx0KCk7XG5cbn1cblxuZnVuY3Rpb24gYm9vdHN0cmFwKCBlcnIsIHNlcnZpY2VzICkge1xuXG5cbiAgICBpZiAoIGVyciApIGNvbnNvbGUuZXJyb3IoIGVyciApOyBlbHNlIHtcblxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCBcImNsaWNrXCIsIGUgPT4gaW52b2tlQ2xpY2tIYW5kbGVyKCBzZXJ2aWNlcywgZSApICk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIFwiY2hhbmdlXCIsIGUgPT4gaW52b2tlSGFuZGxlciggc2VydmljZXMsIGUgKSApO1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCBcInJlZHJhd1wiLCAoKSA9PiByZWRyYXcoIHNlcnZpY2VzICkgKTtcbiAgICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudCggbmV3IEV2ZW50KCBcInJlZHJhd1wiICkgKTtcblxuICAgIH1cblxufVxuZG9jdW1lbnQuZGlzcGF0Y2hFdmVudCggbmV3IEN1c3RvbUV2ZW50KCBcImxvY2F0ZS1zZXJ2aWNlc1wiLCB7IGRldGFpbDogYm9vdHN0cmFwIH0gKSApO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9qcy9jb25zb2xlL21haW4uanMiLCIvKiBnbG9iYWwgZG9jdW1lbnQsIEV2ZW50ICovXG4vKiBlc2xpbnQtZGlzYWJsZSBpbXBvcnQvbm8tZHVwbGljYXRlcyAqL1xuXG5pbXBvcnQgeyB1c2VyRnVuY3Rpb25zIH0gZnJvbSBcIi4uL2Z1bmMvcmVmbGVjdGlvblwiO1xuaW1wb3J0IHsgZGl2LCBzZWN0aW9uLCBib3ggfSBmcm9tIFwiLi4vZnVuYy9odG1sXCI7XG5pbXBvcnQgeyB1bCwgbGksIGIsIHN1YiB9IGZyb20gXCIuLi9mdW5jL2h0bWxcIjtcbmltcG9ydCB7IGJ1dHRvbiwgbGFiZWwsIHNlbGVjdCB9IGZyb20gXCIuLi9mdW5jL2h0bWxcIjtcblxuZnVuY3Rpb24gc2VsZWN0UHJvdmlkZXJCdXR0b24oIHNlcnZpY2UsIHByb3ZpZGVyICkge1xuXG4gICAgY29uc3QgZGF0YSA9IHsgc2VydmljZTogc2VydmljZS5uYW1lLCBwcm92aWRlcjogcHJvdmlkZXIubmFtZSB9O1xuICAgIHJldHVybiBidXR0b24oIFwic2VsZWN0LXByb3ZpZGVyXCIsIGRhdGEsIHByb3ZpZGVyLm5hbWUgfHwgXCI/P1wiICk7XG5cbn1cblxuZnVuY3Rpb24gYXZhaWxhYmxlUHJvdmlkZXJzKCBzZXJ2aWNlICkge1xuXG4gICAgaWYgKCAhc2VydmljZSApIHJldHVybiBcIj8/P1wiO1xuICAgIHJldHVybiB1bCggdHJ1ZSwgc2VydmljZS5wcm92aWRlcnMoKS5maWx0ZXIoIHggPT4geCApLm1hcCggeCA9PiBsaSggc2VsZWN0UHJvdmlkZXJCdXR0b24oIHNlcnZpY2UsIHggKSApICkgKTtcblxufVxuXG5mdW5jdGlvbiBzdW1tYXJpemVQcm92aWRlciggc2VydmljZSApIHtcblxuICAgIGNvbnN0IHsgcHJvdmlkZXIgfSA9IHNlcnZpY2U7XG4gICAgaWYgKCAhcHJvdmlkZXIgKSByZXR1cm4gYiggXCIobm9uZSlcIiApO1xuICAgIHJldHVybiBiKCBgJHtwcm92aWRlci5kZXNjcmlwdGlvbn0gKCAke3Byb3ZpZGVyLm5hbWV9ICkgJHtidXR0b24oIFwiZGVzZWxlY3QtcHJvdmlkZXJcIiwgeyBzZXJ2aWNlOiBzZXJ2aWNlLm5hbWUgfSwgXCIgWCBcIiApfWAgKTtcblxufVxuXG5mdW5jdGlvbiBzZXJ2aWNlTWV0aG9kcyggc2VydmljZSApIHtcblxuICAgIGlmICggIXNlcnZpY2UgKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIGNvbnN0IHNlbGVjdFRlc3QgPSBsYWJlbCggXCJUZXN0OiBcIiwgc2VsZWN0KCBcInRlc3Qtc2VydmljZS1tZXRob2RcIiwgeyBzZXJ2aWNlOiBzZXJ2aWNlLm5hbWUgfSwgQXJyYXkuZnJvbSggdXNlckZ1bmN0aW9ucyggc2VydmljZSApICkgKSApO1xuICAgIGNvbnN0IGhvc3QgPSBkaXYud2l0aENsYXNzKCBcInRlc3QtYXJlYVwiICk7XG4gICAgcmV0dXJuIGRpdiggc2VsZWN0VGVzdCwgaG9zdCApO1xuXG59XG5cbmZ1bmN0aW9uIHN1bW1hcml6ZVNlcnZpY2UoIHNlcnZpY2UgKSB7XG5cbiAgICBpZiAoICFzZXJ2aWNlICkgcmV0dXJuIHNlY3Rpb24oIFwiKG5vdGhpbmcpXCIgKTtcbiAgICByZXR1cm4gYm94LmJpZyhcblxuICAgICAgICBzdWIoIGAke3NlcnZpY2UubmFtZX0gcHJvdmlkZXJgICksXG4gICAgICAgIHN1bW1hcml6ZVByb3ZpZGVyKCBzZXJ2aWNlICksXG4gICAgICAgIHNlcnZpY2VNZXRob2RzKCBzZXJ2aWNlICksXG4gICAgICAgIGBBdmFpbGFibGU6ICR7YXZhaWxhYmxlUHJvdmlkZXJzKCBzZXJ2aWNlICl9YFxuXG4gICAgKTtcblxufVxuXG5mdW5jdGlvbiBvcFNlcnZpY2UoIHNlcnZpY2VzLCBkYXRhICkge1xuXG4gICAgY29uc3Qgc2VydmljZSA9IE9iamVjdC52YWx1ZXMoIHNlcnZpY2VzICkuZmluZCggeCA9PiB4Lm5hbWUgPT09IGRhdGEuc2VydmljZSApO1xuICAgIGlmICggIXNlcnZpY2UgKSB0aHJvdyBuZXcgRXJyb3IoIGBTZXJ2aWNlIG5vdCBrbm93bjogJHtkYXRhLnNlcnZpY2V9YCApO1xuICAgIHJldHVybiBzZXJ2aWNlO1xuXG59XG5cbmZ1bmN0aW9uIG9wU2VydmljZVByb3ZpZGVyKCBzZXJ2aWNlcywgZGF0YSApIHtcblxuICAgIGNvbnN0IHNlcnZpY2UgPSBvcFNlcnZpY2UoIHNlcnZpY2VzLCBkYXRhICk7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBkYXRhLnByb3ZpZGVyID9cbiAgICAgICAgc2VydmljZS5wcm92aWRlcnMoKS5maW5kKCB4ID0+IHgubmFtZSA9PT0gZGF0YS5wcm92aWRlciApIDpcbiAgICAgICAgc2VydmljZS5wcm92aWRlcjtcblxuICAgIGlmICggIXByb3ZpZGVyICkgdGhyb3cgbmV3IEVycm9yKCBgVW5rbm93bi91bnNwZWNpZmllZCBwcm92aWRlcjogJHtkYXRhLnByb3ZpZGVyfWAgKTtcbiAgICByZXR1cm4geyBzZXJ2aWNlLCBwcm92aWRlciB9O1xuXG59XG5cbmZ1bmN0aW9uIG9wU2VydmljZU1ldGhvZCggc2VydmljZXMsIGRhdGEgKSB7XG5cbiAgICBjb25zdCBzZXJ2aWNlID0gb3BTZXJ2aWNlKCBzZXJ2aWNlcywgZGF0YSApO1xuICAgIGNvbnN0IG1ldGhvZCA9IGRhdGEubWV0aG9kID8gc2VydmljZVsgZGF0YS5tZXRob2QgXSA6IHVuZGVmaW5lZDtcbiAgICByZXR1cm4geyBzZXJ2aWNlLCBtZXRob2QgfTtcblxufVxuXG5mdW5jdGlvbiB0ZXN0QXJlYSggc2VydmljZSwgbWV0aG9kICkge1xuXG4gICAgaWYgKCAhbWV0aG9kICkgcmV0dXJuIFwiXCI7XG4gICAgY29uc3QgZiA9IHNlcnZpY2VbIG1ldGhvZCBdO1xuICAgIGNvbnN0IGFyaXR5ID0gZi5sZW5ndGg7XG4gICAgY29uc3QgaW52b2tlRGF0YSA9IHsgc2VydmljZTogc2VydmljZS5uYW1lLCBtZXRob2QgfTtcbiAgICByZXR1cm4gZGl2KFxuICAgICAgICBidXR0b24oIFwiaW52b2tlVGVzdE1ldGhvZFwiLCBpbnZva2VEYXRhLCBcIkludm9rZVwiICksXG4gICAgICAgIGRpdi53aXRoQ2xhc3MoIFwibWVzc2FnZXNcIiApXG4gICAgKTtcblxufVxuXG5leHBvcnQgZGVmYXVsdCBuYW1lID0+ICggbmFtZSA/IG5hbWUucmVwbGFjZSggLy0uL2csIHggPT4geFsgMSBdLnRvVXBwZXJDYXNlKCkgKSA6IG5hbWUgKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHN1bW1hcml6ZVNlcnZpY2VzKCBzZXJ2aWNlcyApIHtcblxuICAgIHJldHVybiBPYmplY3QudmFsdWVzKCBzZXJ2aWNlcyApLm1hcCggc3VtbWFyaXplU2VydmljZSApLmpvaW4oIFwiXCIgKTtcblxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0UHJvdmlkZXIoIHNlcnZpY2VzLCBkYXRhICkge1xuXG4gICAgY29uc3QgeyBzZXJ2aWNlLCBwcm92aWRlciB9ID0gb3BTZXJ2aWNlUHJvdmlkZXIoIHNlcnZpY2VzLCBkYXRhICk7XG4gICAgc2VydmljZS5zZWxlY3QoIHByb3ZpZGVyICk7XG4gICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudCggbmV3IEV2ZW50KCBcInJlZHJhd1wiICkgKTtcblxufVxuXG5leHBvcnQgZnVuY3Rpb24gZGVzZWxlY3RQcm92aWRlciggc2VydmljZXMsIGRhdGEgKSB7XG5cbiAgICBjb25zdCBzZXJ2aWNlID0gb3BTZXJ2aWNlKCBzZXJ2aWNlcywgZGF0YSApO1xuICAgIHNlcnZpY2UuZGVzZWxlY3QoKTtcbiAgICBkb2N1bWVudC5kaXNwYXRjaEV2ZW50KCBuZXcgRXZlbnQoIFwicmVkcmF3XCIgKSApO1xuXG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0ZXN0U2VydmljZU1ldGhvZCggc2VydmljZXMsIGRhdGEsIGUgKSB7XG5cbiAgICBjb25zdCBzZXJ2aWNlID0gb3BTZXJ2aWNlKCBzZXJ2aWNlcywgZGF0YSApO1xuICAgIGNvbnN0IG1ldGhvZCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgIGNvbnN0IGhvc3QgPSBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvciggXCIudGVzdC1hcmVhXCIgKTtcbiAgICBpZiAoICFob3N0ICkgcmV0dXJuO1xuICAgIGhvc3QuaW5uZXJIVE1MID0gdGVzdEFyZWEoIHNlcnZpY2UsIG1ldGhvZCApO1xuXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbnZva2VUZXN0TWV0aG9kKCBzZXJ2aWNlcywgZGF0YSwgZSApIHtcblxuICAgIGNvbnN0IHsgc2VydmljZSwgbWV0aG9kIH0gPSBvcFNlcnZpY2VNZXRob2QoIHNlcnZpY2VzLCBkYXRhICk7XG4gICAgY29uc3QgcGFyYW1ldGVycyA9IEFycmF5XG4gICAgICAgIC5mcm9tKCBlLnRhcmdldC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIFwiaW5wdXRbdHlwZT10ZXh0XVwiICkgKVxuICAgICAgICAubWFwKCB4ID0+IEpTT04ucGFyc2UoIHgudmFsdWUgKSApO1xuICAgIGNvbnN0IG1lc3NhZ2VIb3N0ID0gZS50YXJnZXQucGFyZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yKCBcIi5tZXNzYWdlc1wiICk7XG4gICAgY29uc3QgdGltZXN0YW1wID0geCA9PiBgWyR7KCBuZXcgRGF0ZSgpLnRvTG9jYWxlVGltZVN0cmluZygpICl9XSAke3h9YDtcbiAgICBpZiAoIG1lc3NhZ2VIb3N0ICkgbWVzc2FnZUhvc3QuaW5uZXJIVE1MID0gdGltZXN0YW1wKCBcIlJ1bm5pbmcuLi48YnIgLz5cIiApO1xuICAgIHRyeSB7XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgbWV0aG9kLmFwcGx5KCBzZXJ2aWNlLCBwYXJhbWV0ZXJzICk7XG4gICAgICAgIGNvbnNvbGUubG9nKCByZXN1bHQgKTtcbiAgICAgICAgaWYgKCBtZXNzYWdlSG9zdCApIG1lc3NhZ2VIb3N0LmlubmVySFRNTCArPSB0aW1lc3RhbXAoIEpTT04uc3RyaW5naWZ5KCByZXN1bHQgKSApO1xuXG4gICAgfSBjYXRjaCAoIGV4ICkge1xuXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoIGV4ICk7XG4gICAgICAgIGlmICggbWVzc2FnZUhvc3QgKSBtZXNzYWdlSG9zdC5pbm5lckhUTUwgKz0gZXguc3RhY2s7XG5cbiAgICB9XG5cbn1cblxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2pzL2NvbnNvbGUvb3BzLmpzIiwiY29uc3QgZGVlcFByb3BzID0geCA9PiB4ICYmIHggIT09IE9iamVjdC5wcm90b3R5cGUgJiYgT2JqZWN0LmdldE93blByb3BlcnR5TmFtZXMoIHggKS5jb25jYXQoIGRlZXBQcm9wcyggT2JqZWN0LmdldFByb3RvdHlwZU9mKCB4ICkgKSB8fCBbXSApO1xuY29uc3QgZGVlcEZ1bmN0aW9ucyA9IHggPT4gZGVlcFByb3BzKCB4ICkuZmlsdGVyKCBuYW1lID0+IHR5cGVvZiB4WyBuYW1lIF0gPT09IFwiZnVuY3Rpb25cIiApO1xuY29uc3QgdXNlckZ1bmN0aW9ucyA9IHggPT4gbmV3IFNldCggZGVlcEZ1bmN0aW9ucyggeCApLmZpbHRlciggbmFtZSA9PiBuYW1lICE9PSBcImNvbnN0cnVjdG9yXCIgJiYgIX5uYW1lLmluZGV4T2YoIFwiX19cIiApICkgKTtcblxuLyogZXNsaW50LWRpc2FibGUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydCAqL1xuZXhwb3J0IHsgdXNlckZ1bmN0aW9ucyB9O1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy9qcy9mdW5jL3JlZmxlY3Rpb24uanMiLCJjb25zdCBpc0RlZmluZWQgPSB4ID0+IHR5cGVvZiB4ICE9PSBcInVuZGVmaW5lZFwiO1xuY29uc3QgZGF0YWZ5ID0geCA9PiBPYmplY3Qua2V5cyggeCB8fCB7fSApLnJlZHVjZSggKCByZXQsIGtleSApID0+IGAke3JldH0gZGF0YS0ke2tleX09XCIke3hbIGtleSBdfVwiYCwgXCJcIiApO1xuY29uc3QgYnJlYWtVcCA9IHhzID0+IHhzLmZpbHRlciggaXNEZWZpbmVkICkuam9pbiggXCI8YnIgLz5cIiApO1xuXG5leHBvcnQgY29uc3Qgc3ViID0gKCAuLi54ICkgPT4gYDxzcGFuIGNsYXNzPVwic3ViLWhlYWRpbmdcIj4ke2JyZWFrVXAoIHggKX08L3NwYW4+YDtcbmV4cG9ydCBjb25zdCBiID0gKCAuLi54ICkgPT4gYDxzcGFuIGNsYXNzPVwiYm9sZFwiPiR7YnJlYWtVcCggeCApfTwvc3Bhbj5gO1xuZXhwb3J0IGNvbnN0IGJveCA9ICggLi4ueCApID0+IGA8ZGl2IGNsYXNzPVwiYm94XCI+JHticmVha1VwKCB4ICl9PC9kaXY+YDtcbmJveC5iaWcgPSAoIC4uLnggKSA9PiBgPGRpdiBjbGFzcz1cImJveCBiaWctYm94XCI+JHticmVha1VwKCB4ICl9PC9kaXY+YDtcblxuZXhwb3J0IGNvbnN0IHNlY3Rpb24gPSAoIC4uLnggKSA9PiBgPHNlY3Rpb24+JHticmVha1VwKCB4ICl9PC9zZWN0aW9uPmA7XG5leHBvcnQgY29uc3QgZGl2ID0gKCAuLi54ICkgPT4gYDxkaXY+JHticmVha1VwKCB4ICl9PC9kaXY+YDtcbmRpdi53aXRoQ2xhc3MgPSAoIGNsYXNzTmFtZSwgLi4ueCApID0+IGA8ZGl2IGNsYXNzPVwiJHtjbGFzc05hbWV9XCI+JHticmVha1VwKCB4ICl9PC9kaXY+YDtcbmV4cG9ydCBjb25zdCBhcnRpY2xlID0gKCBoZWFkLCBib2R5ICkgPT4gYDxhcnRpY2xlPjxoZWFkZXI+JHtoZWFkfTwvaGVhZGVyPiR7Ym9keX08L2FydGljbGU+YDtcblxuZXhwb3J0IGNvbnN0IHVsID0gKCBpbmxpbmUsIHggKSA9PiBgPHVsIGNsYXNzPVwiJHtpbmxpbmUgPyBcImlubGluZVwiIDogXCJcIn1cIj4ke3guam9pbiggXCJcIiApfTwvdWw+YDtcbmV4cG9ydCBjb25zdCBsaSA9IHggPT4gYDxsaT4ke3h9PC9saT5gO1xuXG5leHBvcnQgY29uc3QgbGFiZWwgPSAoIHQsIGMgKSA9PiBgPGxhYmVsPiR7dH0ke2N9PC9sYWJlbD5gO1xuZXhwb3J0IGNvbnN0IGJ1dHRvbiA9ICggb3AsIGRhdGEsIGNvbnRlbnQgKSA9PiBgPGJ1dHRvbiBkYXRhLWhhbmRsZXI9XCIke29wfVwiICR7ZGF0YSA/IGRhdGFmeSggZGF0YSApIDogXCJcIn0+JHtjb250ZW50fTwvYnV0dG9uPmA7XG5leHBvcnQgY29uc3Qgb3B0aW9uID0gKCB2YWx1ZSwgdGV4dCApID0+IGA8b3B0aW9uIHZhbHVlPVwiJHt2YWx1ZX1cIj4ke3RleHQgfHwgdmFsdWV9PC9vcHRpb24+YDtcbmV4cG9ydCBjb25zdCBvcHRpb25zID0gb3B0cyA9PiBgPG9wdGlvbj48L29wdGlvbj4ke29wdHMubWFwKCBvID0+IG9wdGlvbiggbyApICl9YDtcbmV4cG9ydCBjb25zdCBzZWxlY3QgPSAoIG9wLCBkYXRhLCBvcHRzICkgPT4gYDxzZWxlY3QgZGF0YS1oYW5kbGVyPVwiJHtvcH1cIiAke2RhdGFmeSggZGF0YSApfT4ke29wdGlvbnMoIG9wdHMgKX08L3NlbGVjdD5gO1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2pzL2Z1bmMvaHRtbC5qcyJdLCJzb3VyY2VSb290IjoiIn0=